probs = factorial(N) / (factorial(X) * factorial(N-X)) * P^X * (1-P)^(N-X)
names(probs) = X
barplot(probs , xlab = "Number of seeds taken" , ylab = "Probability")
dbinom(X)
dbinom(0.4,X)
dbinom(prob = 0.4 , size = N)
?dbinom
dbinom(x = X , size = N , prob = P)
probs = dbinom(x = X , size = N , prob = P)
barplot(probs , xlab = "Number of seeds taken" , ylab = "Probability")
names(probs) = X
barplot(probs , xlab = "Number of seeds taken" , ylab = "Probability")
set.seed(1001)
x = rbinom(1000, 5, 0.1)
f = as.factor(x , levels = c(0:5))
f = factor(x , levels = c(0:5))
plot(f)
plot(f , density = T)
plot(f)
set.seed(1001)
x = rbinom(100, 5, 0.5)
f = factor(x , levels = c(0:5))
plot(f)
set.seed(1001)
x = rbinom(1000, 100, 0.5)
f = factor(x , levels = c(0:100))
plot(f)
x = rbinom(10000, 100, 0.5)
f = factor(x , levels = c(0:100))
plot(f)
E = seq(0,10,.2)^10
x50=5000
eps=0.3
E = seq(0,10,.2)^10
out = (eps*E)/(E+x50)
plot(out~E)
seq(0,10,.2)^10
hist(E)
plot(out~log10(E))
E = 0:200
out = (eps*E)/(E+x50)
plot(out~log10(E))
install.packages("bbmle")
install.packages("emdbook")
a1 = sin(seq(0,2*pi,.1)) + 1
a1
A <- matrix(c(2,1,3,1) , nrow = 2 , ncol= 2)
B <- matrix(c(0.5,5,2,1) , nrow = 2 , ncol = 2)
C <- A %*% B
C
I <- matrix(c(1,1,1,1) , nrow = 2 , ncol = 2)
C %*% I
I <- matrix(c(1,0,1,0) , nrow = 2 , ncol = 2)
C %*% I
x <- c(0.1,0.3,0.42,0.6,0.9)
sed.seed(1001)
set.seed(1001)
y <- rnorm(5 , mean = 2*x+1 , sd = 0.2)
y
plot(x,y)
dim(X) <- c(5,2)
X <- rep(1,10)
dim(X) <- c(5,2)
X
X[,2] = x
X
y
Y <- y
dim(Y) <- c(5,1)
Y
#now, solve OLS
solve(X)
#now, solve OLS
solve(A)
A
(solve(t(X) %*% X) %*% t(X)) %*% Y
#(X'X)-1(X'y)
solve(t(X) %*% X) %*% t(X) %*% Y
summary(lm(y~x))
install.packages("pgirmess")
library(dplyr)
library(ggplot2)
acs = read.csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/acs2015_county_data.csv",
stringsAsFactors = F)
head(acs)
acs = arrange(acs , desc(Income))
acs_states = group_by(acs , State)
is.numeric_int = function(x) { is.numeric(x) | is.integer(x) }
acs_max = summarize_if(acs_states , is.numeric_int , c("first" , "last" , "mean"))
acs_max = arrange(acs_max , Income_first)
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() , axis.title.y = element_blank()) +
ggtitle("Income of highest- and lowest- earning counties") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
# geom_text(aes(x = -1 * Income_last , y = seq(1,nrow(acs_max),2) , label = State) ,
#           data = slice(acs_max,seq(1,nrow(acs_max),2)) , size= 3 , hjust = 1) +
# geom_text(aes(x = Income_first , y = seq(2,nrow(acs_max),2) , label = State)  ,
#           data = slice(acs_max,seq(2,nrow(acs_max),2)) ,  hjust = 0 , size = 3) +
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
png("tidytuesday_0501.png")
p
dev.off()
png("tidytuesday_0501.png",6,5)
p
dev.off()
?png
png("tidytuesday_0501.png",600,600)
p
dev.off()
png("tidytuesday_0501.png",600,500)
p
dev.off()
?geom_text
png("tidytuesday_0501.png",600,500)
p
dev.off()
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() , axis.title.y = element_blank()) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
png("tidytuesday_0501.png",600,500)
p
dev.off()
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() , axis.title.y = element_blank()) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() , legend.position = c(0.8,0.5)) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() , legend.position = c(0.9,0.3)) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
?theme
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() , legend.position = c(1,0)) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() , legend.position = c("bottom","right")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,0) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,0) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) , labels = c(50,0,50,100)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0) +
scale_x_continuous(expand = c(.1, .1))
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(.1, .1)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0) +
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(.1, .1)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(0, .2)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(.2, .2)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(.12, .12)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
?scale_x_continuous
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(0, .12)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(0.1, 0)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
p <- ggplot(acs_max) +
geom_segment(aes(x = Income_first , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color = Black_first) , size = 2) +
geom_segment(aes(x = (-1) * IncomePerCap_last , xend = 0 , y = 1:nrow(acs_max) , yend = 1:nrow(acs_max),
color =  Black_last), size = 2) +
geom_point(aes(x = Income_first ,  y = 1:nrow(acs_max))) +
geom_point(aes(x = (-1) * IncomePerCap_last ,  y = 1:nrow(acs_max) )) +
scale_colour_gradient2(low = "blue",mid="grey",high = "red" ,name="Percent black",midpoint=12.3) +
theme_classic() +
theme(axis.ticks.y = element_blank() , axis.text.y = element_blank() ,
axis.title.y = element_blank() ,
legend.position = c(1,.01) , legend.justification = c("right","bottom")) +
ggtitle("Income of highest- and lowest- earning counties per state") +
scale_x_continuous("Household Income (K USD)", breaks = c(-50000,0,50000,100000) ,
labels = c(50,0,50,100) , expand = c(0.15, 0)) +
geom_vline(xintercept = 0)+
geom_text(aes(x = Income_first+3000 , y = seq(1,nrow(acs_max),1) , label = State) ,
size= 3 ,hjust = 0) +
geom_text(aes(x = -3000 , y = 54 , label = c("Lowest earning county")) , hjust = 1) +
geom_text(aes(x = 3000 , y = 54 , label = c("Highest earning county")) , hjust = 0)
p
library(updateR)
library(updater)
install.packages("updateR")
library(installr)
install.packages("installr")
library(xlsx)
setwd("~/Documents/tidy_tuesday")
?read.xlsx
starbucks = read.xlsx("week6_coffee_chains.xlsx" , 1)
starbucks = read.xlsx("week6_coffee_chains.xlsx" , sheetName = "starbucks")
starbucks = read.xlsx("week6_coffee_chains.xlsx" , sheetName = "timhorton")
horton = read.xlsx("week6_coffee_chains.xlsx" , 2, sheetName = "timhorton")
horton = read.csv("timhorton.csv" , stringsAsFactors = F)
starbucks = read.csv("starbucks.csv" , stringsAsFactors = F)
dunkin = read.csv("dunkin.csv" , stringsAsFactors = F)
names(horton)
names(starbucks)
names(dunkin)
