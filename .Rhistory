geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.3,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"))+
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"))+
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5) , color = rgb(.2,.3,1)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"))+
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black") ,
axis.title = element_text(color  = "red"))+
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black") ,
axis.title.y = element_text(color  = "red"))+
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"))
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.95,.95) , legend.justification = c("right","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.3,.9) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.2,.8) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(.2,.9) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0,.99) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,.95) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.line.y.right = element_line(color = rgb(.2,.3,1))) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black")) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1))) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1))) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text("PErceip",color = rgb(.2,.3,1))) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1))) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1)),
axis.text.y.left = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1)),
axis.text.y = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.label.y.right = element_text(color = rgb(.2,.3,1)),
axis.label.y = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
?theme
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1)),
axis.text.y = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = "blue") +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = "blue"),
axis.text.y = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1)),
axis.text.y = element_text(color = brewer.pal(8,"PiYG")[8])) +
ggtitle("Bike when it's dry!")
p
p <- ggplot(dateSummary , aes(x = StartDate , y = count)) +
geom_col(aes(fill = Duration)) +
theme_classic(base_size = 14) +
scale_fill_gradient2("Median ride time (mins)",low =  brewer.pal(8,"PiYG")[8], mid = brewer.pal(8,"PiYG")[4],high = brewer.pal(11,"PiYG")[1],
midpoint = 15) +
ylab("Number of rides (per day)") + xlab("Date") +
scale_x_date(date_breaks = "3 month", date_labels =  "%b %Y") +
geom_col(aes(x = StartDate , y = -1 * precip*1000) , color = rgb(.2,.3,1)) +
scale_y_continuous(breaks = seq(0,3000,1000),
sec.axis = sec_axis(~ . / (-1000) ,name = "Precipitation (in)",
breaks = seq(0,2.2,.5)))+
geom_line(y=0) +
theme(legend.position = c(0.05,1) , legend.justification = c("left","top") ,
legend.direction = "horizontal" , legend.title=element_text(size=10),
legend.text=element_text(size=8),
plot.title = element_text(hjust = 0.5,size = 20,face="bold"),
legend.box.background = element_rect(color = "black"),
axis.text.y.right = element_text(color = rgb(.2,.3,1)),
axis.text.y = element_text(color = brewer.pal(8,"PiYG")[1])) +
ggtitle("Bike when it's dry!")
p
